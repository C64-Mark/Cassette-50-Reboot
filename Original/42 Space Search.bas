!--------------------------------------------------
!- 28 October 2019 21:19:32
!- Import of : SEARCH.PRG
!- From Disk : c:\users\marka\games\c64\cbmprg\cassette50reboot\spacesearch.d64
!- Commodore 64
!--------------------------------------------------
90 DIMA(10,10)
100 GOSUB1000:PRINT"{blue}":GOSUB2900:GOSUB6000:GOSUB5200:GOSUB2800:IFS1=1THEN100
350 GOSUB5300:IFA1=3THEN970
420 ONA1GOTO20000,21000,22000,23000,24000,25000,26000,27000,28000,970
970 PRINT"{ct g}":PRINT"{clear}";:END
1000 D$="{ct d}":D9=1:N$="{space*14}space search":RETURN
2400 POKE53281,1:PRINT"{reverse on}":PRINT"{space*9}{reverse on}{sh asterisk*3}cascade{sh asterisk}(c){sh asterisk}1984{sh asterisk*3}":RETURN
2500 INPUTA$:A1=VAL(A$):RETURN
2600 GETA$:IFA$=""THEN2600
2620 A1=VAL(A$):RETURN
2700 S1=0:IFA1>=L1ANDA1<=L2THEN2790
2720 S1=1:GOSUB3600
2790 RETURN
2800 T1=1:X9=1:Y9=22:GOSUB7700:PRINTTAB(T1):PRINT" enter{space*2}choice";:GOSUB2600:GOSUB2700:RETURN
2900 PRINT"{clear}";:GOSUB2400:PRINT:T1=(21-LEN(N$))/2:PRINTN$:PRINT:GOSUB2400:PRINT:PRINT:PRINT:RETURN
3000 X9=1:Y9=22:GOSUB7700:T1=1:PRINTTAB(T1):INPUT" press{space*2}return";A$:RETURN
3190 RETURN
3400 GOSUB3100:GOSUB2000:GOSUB2100:INPUTA$:GOSUB2300:A1=VAL(A$):S1=0:IFA1=0THENS1=1
3490 RETURN
3600 N1$="out of range":GOSUB4200:GOSUB4500:GOSUB3000:RETURN
3900 GOSUB3400:IFS1=1THENGOSUB3500
3990 RETURN
4200 N2$=N$:N$=N1$:GOSUB2900:N$=N2$:RETURN
4500 PRINT"{ct g*3}":RETURN
4610 A$="
4630 GETZ$:IFASC(Z$)=8ANDLEN(A$)=0THEN4610
4650 IFASC(Z$)=8THEN4760
4660 IFASC(Z$)=13THEN4980
4670 IFASC(Z$)=27THEN4900
4680 IFZZ<>0THEN4700
4690 IFASC(Z$)>64ANDASC(Z$)<91THENZ$=CHR$(ASC(Z$)+32)
4702 ZA=ASC(Z$):IFZA>96ANDZA<123THENPRINTCHR$(ZA-32);
4710 IFZA<97ORZA>122THENPRINTZ$;
4720 A$=A$+Z$:IFZZ=1THENZZ=0
4750 GOTO4630
4760 IFLEN(A$)=1THEN4830
4770 IFPEEK(36)=0THEN4790
4780 GOTO4812
4830 A$="":GOTO4814
4900 IFZZ=0THEN4940
4910 IFZZ=1THEN4960
4920 ZZ=0:GOTO4630
4940 ZZ=1:GOTO4630
4960 ZZ=2:GOTO4630
4980 PRINT:RETURN
5000 A2=LEN(A$):IFA2=0THEN5090
5030 FORA1=1TOA2:A3=ASC(MID$(A$,A1,1)):IFA3<97ORA3>122THENPRINTCHR$(A3);
5060 IFA3>96ANDA3<123THENPRINTCHR$(A3-32);
5070 NEXTA1:PRINT
5090 RETURN
5200 FORA1=L1TOL2:PRINTTAB(T1)A1" = "M$(A1):NEXTA1:RETURN
5300 N$="-+*# "+M$(A1)+" #*+-":RETURN
5500 GOSUB2900:T1=7:PRINTTAB(T1)"press 'return' only to exit":INPUT"";A$:IFA$=""THEN5590
5540 A1=VAL(A$):IFLEN(A$)>=L3ANDLEN(A$)<=L4THEN5590
5560 GOSUB3600:GOTO5500
5590 RETURN
6000 L1=1:L2=3:M$(1)="instructions":M$(2)="game":M$(3)="exit":T1=1:RETURN
6100 FORX1=1TO10:FORY1=1TO10:A(X1,Y1)=0:NEXTY1:NEXTX1:RETURN
6200 FORA1=1TO1+X+Y:X=RND(1):NEXTA1:FORA1=1TO10:A(A1,1)=INT(RND(1)*39)+1:A(A1,2)=INT(RND(1)*18)+1:A(A1,4)=INT(RND(1)*18):NEXTA1:A(INT(RND(1)*10)+1,5)=1:X=1:Y=1:F=30:X1=0:Y1=0:C1=0:V1=0:I1=0:RETURN
6300 PRINT"{clear}";:FORA1=1TO20:PRINT"{space*20}":NEXTA1:FORA1=1TO10:X9=A(A1,1):Y9=A(A1,2):GOSUB7700:PRINT"{red}Q":NEXTA1:GOSUB7000:RETURN
6400 Y9=Y:X9=X:GOSUB7700:PRINT"{green}.":RETURN
6500 GOSUB7300:IFA$="q"THENY1=-1
6520 IFA$="z"THENY1=1
6530 IFA$="i"THENX1=-1
6540 IFA$="p"THENX1=1
6550 X=X+X1:Y=Y+Y1:IFX=0THENX=1
6562 IFX=40THENX=39
6564 IFY=0THENY=1
6566 IFY=21THENY=20
6570 F=F-1:GOSUB7000:RETURN
6600 Y9=Y:X9=X:GOSUB7700:PRINT"{blue}Z":RETURN
6700 FORA1=1TO10:IFA(A1,1)=XANDA(A1,2)=YTHENC1=1
6712 IFABS(A(A1,1)-X)<2ANDABS(A(A1,2)-Y)<2THENGOSUB7600
6720 NEXTA1:RETURN
6800 GOSUB7200:PRINT"orbitting planet "V1:FORA1=1TO2000:NEXTA1:PRINTA(V1,4)" units of fuel":F=F+A(V1,4):FORA1=1TO2000:NEXTA1:X9=A(V1,1):Y9=A(V1,2):GOSUB7700:PRINT"*":V1=0:GOSUB7000:RETURN
6900 PRINT"{clear}";:X9=1:Y9=10:GOSUB7700:PRINT"you are out of fuel":PRINT"{ct g*5}":FORA1=1TO2000:NEXTA1:RETURN
7000 GOSUB7200:PRINT"x="X"y="Y"fuel="F:RETURN
7200 X9=1:Y9=19:GOSUB7700:FORA1=1TO3:PRINT"{space*20}":NEXTA1:X9=1:Y9=19:GOSUB7700:RETURN
7300 K1=255:GETA$:IFA$<>""THENK1=ASC(A$)
7390 RETURN
7400 PRINT"{clear}";:X9=1:Y9=10:GOSUB7700:PRINT"crashed into planet":FORA=1TO2000:NEXTA:RETURN
7500 PRINT"{clear}";:PRINT"{down}you have found the correct planet.":PRINT:PRINT"your search is at an end. well done.":PRINT:PRINT"you had "F" units of fuel left":PRINT:FORA1=1TO5000:NEXTA1:RETURN
7600 IFA(A1,3)=0THENA(A1,3)=1:V1=A1:IFA(A1,5)=1THENI1=1
7690 RETURN
7700 PRINT"{home}";:IFX9=1THEN7750
7720 FORU=1TOX9-1:PRINT"{right}";:NEXTU
7750 IFY9=1THEN7790
7760 FORU=1TOY9-1:PRINT"{down}";:NEXTU
7790 RETURN
20000 PRINT"{clear}{reverse on}";:PRINT"space search":PRINT"{down}instructions:":PRINT"{down}you must find a planet capable of{space*7}supporting life.":PRINT"{down}if you collide with a planet you lose.":PRINT"{down}if you fly next to a planet you can take";
20050 PRINT" on fuel & check if it's the planet you":PRINT"have been searching for.":PRINT"{down}your fuel level{space*2}is always decreasing.":PRINT"{down}q=up{space*8}z=down":PRINT"i=left{space*6}p=right.":PRINT"Z = your ship":PRINT"Q = planet":GOSUB3000:GOTO100
21000 PRINT"{clear}";:GOSUB6100:GOSUB6200:GOSUB6300
21030 GOSUB6400:GOSUB6500:GOSUB6600:GOSUB6700:IFC1=1THENGOSUB7400:GOTO100
21080 IFV1<>0THENGOSUB6800
21090 IFI1=1THENGOSUB7500:GOTO100
21100 IFF<1THENGOSUB6900:GOTO100
21980 GOTO21030
21990 GOTO100
