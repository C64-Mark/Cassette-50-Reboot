!--------------------------------------------------
!- 27 October 2019 22:21:55
!- Import of : PONT.PRG
!- From Disk : c:\users\marka\games\c64\cbmprg\cassette50reboot\pontoon.d64
!- Commodore 64
!--------------------------------------------------
10 REMDIMENSIONSSECTION.
20 DIMP(52),N$(13)
40 REMHEADINGANDINSTRUCTIONSSECTION.
50 PRINT"{clear}";
60 PRINT"pontoon."
70 PRINT"========"
80 GOSUB1600
90 GOSUB1700
100 REMCONTROLSECTION.
110 GOSUB1010
200 GOSUB10000
990 STOP
1000 REMGOSUBSECTION.
1010 REMINITIALISEGOSUB
1020 FORA1=0TO3
1030 READP$(A1)
1040 NEXTA1
1050 FORA1=1TO13
1060 READN$(A1)
1070 NEXTA1
1080 DATA"hearts","diamonds","clubs","spades"
1090 DATA"ace","two","three","four","five","six","seven"
1100 DATA"eight","nine","ten","jack","queen","king"
1190 RETURN
1200 REMA$ASASTRINGGOSUB
1210 PRINT
1220 INPUTA$
1230 PRINT
1240 RETURN
1300 REMA$ASANUMERALGOSUB
1310 GOSUB1200
1320 A3=VAL(A$)
1330 IFA$="0"ORA3<>0THEN1390
1340 PRINT
1350 PRINT"numbers only please.{space*2}re-input:"
1360 PRINT
1370 GOTO1300
1390 RETURN
1400 REMA$ASANANSWERGOSUB
1410 GOSUB1200
1420 IFA$="yes"THEN1490
1430 IFA$="no"THEN1510
1440 PRINT
1450 PRINT"enter yes or no:"
1460 PRINT
1470 GOTO1400
1490 A3=1
1500 GOTO1590
1510 A3=0
1590 RETURN
1600 REMQUATERPAGECLEARGOSUB
1610 FORA1=1TO3
1620 PRINT
1630 NEXTA1
1640 RETURN
1700 REMINSTRUCTIONSGOSUB
1710 PRINT
1720 PRINT"would you like"
1721 PRINT"instructions"
1730 PRINT
1740 GOSUB1400
1750 IFA3=0THEN3900
1760 PRINT"{clear}";
1770 PRINT"pontoon instructions"
1780 PRINT"********************"
1790 GOSUB1600
1800 PRINT"a pontoon (ace & royal or ace & ten)"
1810 PRINT"beats everthing else."
1820 PRINT"only a pontoon beats a 5 card trick."
1830 PRINT"the computer only pays higher scores,"
1840 PRINT"a hand over 21 goes bust."
1850 INPUT"press return";A$
1860 PRINT"you cannot stick under 16 without a five card trick.
1870 PRINT"aces count as one or eleven."
1900 PRINT
1910 PRINT"you will have to work hard to"
1920 PRINT"beat the computer!!"
3890 GOSUB4000
3900 RETURN
4000 REMPAUSINGGOSUB
4010 PRINT
4020 PRINT"pausing.{space*2}press return to continue:"
4030 GOSUB1200
4040 RETURN
5000 PRINT"{clear}";
5004 PRINT"shuffling."
5010 FORA1=1TO52
5020 P(A1)=0
5030 NEXTA1
5040 FORA1=1TO52
5050 W=W+1
5060 F=INT(RND(W)*52+1)
5070 IFP(F)<>0THEN5200
5080 P(F)=A1
5090 GOTO5300
5200 F=F+1
5210 IFF=53THENF=F-52
5220 GOTO5070
5300 NEXTA1
5310 RETURN
5500 REMSHIFTINGDOWN1GOSUB
5510 T1=P(1)
5520 FORA1=1TO51
5530 P(A1)=P(A1+1)
5540 NEXTA1
5550 P(52)=T1
5560 RETURN
6000 REMCARDPRINTGOSUB
6010 P9=INT((P1-1)/13)
6020 N9=P1-(P9*13)
6030 PRINTN$(N9);" of ";P$(P9)
6040 T(C1)=N9
6050 RETURN
6100 REMDEALPLAYERACARDGOSUB
6110 Z9=Z9+1
6120 Y(Z9)=P(1)
6130 GOSUB5500
6140 RETURN
6200 REMDEALCOMPUTERACARDGOSUB
6210 Z8=Z8+1
6220 D(Z8)=P(1)
6230 GOSUB5500
6240 RETURN
6300 REMPLAYER'SCARDSPRINTGOSUB
6320 PRINT"your cards are:-"
6330 PRINT
6340 FORC1=1TOZ9
6350 P1=Y(C1)
6360 GOSUB6000
6370 NEXTC1
6380 PRINT
6390 RETURN
6400 REMCHECKINGFORPLAYER'SACEGOSUB
6410 Z5=1
6420 FORD1=1TOZ9
6430 IFT(D1)=1THENZ5=Z5+1
6440 NEXTD1
6450 FORD1=1TOZ5
6455 J(D1)=0
6460 FORH1=1TOZ9
6462 Q1=T(H1)
6464 IFQ1>10THENQ1=10
6470 J(D1)=J(D1)+Q1
6480 NEXTH1
6490 J(D1)=J(D1)+(D1-1)*10
6495 PRINTJ(D1)
6500 NEXTD1
6590 RETURN
6600 REMISPLAYERALLOWEDTOSTICKGOSUB
6604 S5=0
6605 S6=0
6606 V1=0
6610 FORD1=1TOZ5
6630 IFJ(D1)>15ANDJ(D1)<22THENS5=1
6640 IFJ(D1)<22THENS6=1
6650 NEXTD1
6655 IFS6=0THEN6790
6656 IFZ9=5THEN6790
6657 IFZ9=2ANDZ5=2ANDJ(2)=21THENV1=1
6658 IFV1=1THEN6790
6660 PRINT
6670 PRINT"would you like another card ?"
6690 GOSUB1400
6700 IFA3=0ANDS5=0THENPRINT"you can't stick!"
6790 RETURN
6800 REMPLAYERLOSESGOSUB
6810 CO1=CO1+1
6820 PRINT
6830 PRINT"you lose i'm afraid!"
6840 PRINT
6850 GOSUB6900
6860 RETURN
6900 REMSCOREBOARDGOSUB
6910 PRINT"{clear}";
6920 PRINT"computer{space*11}you"
6930 PRINT
6940 PRINTTAB(3)CO1;TAB(19)YO1
6950 PRINT
6960 RETURN
7000 REMDEALER'SCARDPRINTGOSUB
7002 PRINT
7004 PRINT"my cards are:-"
7006 PRINT
7010 FORC1=1TOZ8
7020 P1=D(C1)
7030 GOSUB6000
7040 NEXTC1
7050 PRINT
7060 FORA=1TO500:NEXTA
7090 RETURN
7100 REMCHECKINGFORDEALER'SACESGOSUB
7110 Z4=1
7120 FORD1=1TOZ8
7130 IFT(D1)=1THENZ4=Z4+1
7140 NEXTD1
7150 FORD1=1TOZ4
7160 N(D1)=0
7170 FORH1=1TOZ8
7180 Q1=T(H1)
7190 IFQ1>10THENQ1=10
7200 N(D1)=N(D1)+Q1
7210 NEXTH1
7220 N(D1)=N(D1)+(D1-1)*10
7230 PRINTN(D1)
7240 NEXTD1
7250 RETURN
7300 REMDEALERWINLOSEORDEALGOSUB
7310 L1=0
7320 L2=0
7400 IFZ8=2ANDZ4=2ANDN(2)=21THENL1=1
7410 IFL1=1THEN7690
7420 IFV1=1THEN7690
7450 FORM1=1TOZ5
7500 FORM2=1TOZ4
7510 IFN(M2)>21THEN7550
7520 IFJ(M1)<16THEN7540
7530 IFN(M2)>=J(M1)THENL1=1
7540 L2=1
7550 NEXTM2
7560 NEXTM1
7580 IFZ9=5ANDZ8<>5ANDL2=1THENL1=0
7690 FORA=1TO1500:NEXTA:RETURN
7700 REMDEALERLOSESGOSUB
7710 YO1=YO1+1
7720 PRINT
7730 PRINT"computer loses:"
7740 FORA=1TO1000:NEXTA
7750 GOSUB6900
7760 RETURN
10000 REMPROGRAMPROPERSECTION.
10010 GOSUB5000
10050 FORB1=1TO10
10070 Z9=0
10080 Z8=0
10090 S5=0
10100 Z4=0
10120 GOSUB6200
10130 GOSUB6200
10170 GOSUB6100
10180 GOSUB6100
10200 GOSUB6300
10220 GOSUB6400
10240 GOSUB6600
10260 IFS6=0THEN10900
10270 IFZ9=5THEN10400
10272 IFV1=1THEN10400
10280 IFA3=1ORS5=0THEN10180
10400 GOSUB7000
10410 GOSUB7100
10420 GOSUB7300
10450 IFL1=1THEN10900
10470 IFL2=1THENGOSUB6200
10490 IFL2=1THEN10400
10600 GOSUB7700
10700 GOTO11000
10900 GOSUB6800
11000 NEXTB1
11100 PRINT
11110 PRINT"would you like me to shuffle ?"
11120 PRINT
11130 GOSUB1400
11140 IFA3=0THEN10050
11150 GOTO10010
14990 RETURN
