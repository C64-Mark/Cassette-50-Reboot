!--------------------------------------------------
!- 27 October 2019 22:38:25
!- Import of : NIM.PRG
!- From Disk : c:\users\marka\games\c64\cbmprg\cassette50reboot\nim.d64
!- Commodore 64
!--------------------------------------------------
90 DIMN(3),B(3,4),S(4):POKE53281,0
100 GOSUB1000:GOSUB1500:IFG$="q"THEN980
114 GOTO130
120 GOSUB1600
130 GOSUB2100:GOTO3130
980 GOSUB1700:STOP
1000 B=1:GOSUB2000:R=0:X=240:Y=160:Y1=0:S1=300:F1=2000:R1=15000:RETURN
1500 PRINT"{clear}{yellow}";:PRINT"{reverse on}nim":PRINT:PRINT"instructions":PRINT:PRINT"there are three rows{space*2}of balls.":PRINT"you may take any ";:PRINT"number of balls (Q){space*4}from any row":PRINT"the player who takes ":PRINT"the last ball or balls wins the game.":GOSUB1600:RETURN
1600 Y=20:X=1:GOSUB4000:PRINT"game or quit":PRINT"enter g or q":GOSUB1800:IFG$<>"g"ANDG$<>"q"THEN1600
1690 RETURN
1700 PRINT"{clear}";:PRINT"{ct g*3}":PRINT"end of game":RETURN
1800 GETG$:RETURN
1900 PRINT"{clear}";:RETURN
2000 PRINT"{ct g*4}":RETURN
2100 GOSUB1900:RETURN
2200 GOSUB1800:K$=G$:RETURN
3130 GOSUB1900:FORP=1TO3:N(P)=INT(10*RND(1))+6:NEXTP:GOSUB3900
3210 X=1:Y=20:GOSUB4000:PRINT"which row?
3220 GOSUB2200:IFK$=""THEN3220
3222 K=ASC(K$):IFK<49ORK>51THEN3210
3224 P=VAL(K$):Y=21:GOSUB4000:PRINT"{space*19}":X=1:Y=21:GOSUB4000:PRINT"row"P"how many";:INPUTN1:IFN1<1ORN1>N(P)THEN3210
3234 X=1:Y=21:GOSUB4000:PRINT"{space*14}":X=1:Y=21:GOSUB4000:PRINT"{space*20}":N(P)=N(P)-N1:IFN(1)+N(2)+N(3)>0THENGOSUB3900:GOTO3370
3290 GOSUB1900:Y=11:X=13:GOSUB4000:PRINT"you win":J1=J1+1:FORP=1TO2500:NEXTP:GOTO100
3370 FORP=1TO3:X=N(P):FORC=4TO1STEP-1:Y=INT(X/2):B(P,C)=X-2*Y:X=Y:NEXTC:NEXTP:FORC=1TO4:X=B(1,C)+B(2,C)+B(3,C):S(C)=X-2*INT(X/2):NEXTC:IFS(1)+S(2)+S(3)+S(4)>0THEN3615
3550 FORP=1TO3:IFN(P)=0THEN3590
3570 N1=INT(N(P)*RND(0)+1):GOTO3770
3590 NEXTP
3615 FORC=1TO4:IFS(C)>0THEN3650
3640 NEXTC
3650 FORP=1TO3:IFB(P,C)=1THEN3680
3670 NEXTP
3680 N1=0:FORC=CTO4:IFS(C)=0THEN3750
3710 X=2^(4-C):IFB(P,C)=0THEN3740
3730 N1=N1+X:GOTO3750
3740 N1=N1-X
3750 NEXTC
3770 X=1:Y=21:GOSUB4000:PRINT"my move"N1"from row"P:FORA=1TO2500:NEXTA:Y=21:GOSUB4000:PRINT"{space*20}":N(P)=N(P)-N1:IFN(1)+N(2)+N(3)>0THEN3850
3830 I1=I1+1:GOSUB1900:Y=11:X=13:GOSUB4000:PRINT"i win":FORA=1TO2500:NEXTA:GOTO100
3850 GOSUB3900:GOTO3210
3900 FORP=1TO3:Y=3+4*P:X=5:GOSUB4000:PRINT"{space*19}":IFN(P)=0THEN3920
3910 Y=3+4*P:X=1:GOSUB4000:PRINT"{purple}row"P;:FORG=1TON(P):PRINT"{blue}Q";:NEXTG:PRINT
3920 NEXTP:Y=1:X=1:GOSUB4000:PRINT"{red}you "J1:Y=1:X=10:GOSUB4000:PRINT"{green}me "I1:RETURN
4000 PRINT"{home}";:IFX=1THEN4040
4020 FORO8=1TOX:PRINT"{right}";:NEXTO8
4040 IFY=1THEN4090
4050 FORO8=1TOY:PRINT"{down}";:NEXTO8
4090 RETURN
