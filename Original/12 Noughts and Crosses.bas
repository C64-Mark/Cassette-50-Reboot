!--------------------------------------------------
!- 27 October 2019 22:21:12
!- Import of : NOUGHT.PRG
!- From Disk : c:\users\marka\games\c64\cbmprg\cassette50reboot\noughts.d64
!- Commodore 64
!--------------------------------------------------
102 Z6=83:TB=1:PRINT"{clear}{yellow}";:PRINT"{space*8}noughts and crosses":PRINT"{space*8}oxoxoxoxoxoxoxoxoxo":PRINT"{down*4}to tell the computer your move:":PRINT"enter 1-3 for the row then the column":PRINT:PRINT"first number = row,{space*3}second = column.":PRINT
234 PRINT"to abort game ie:stalemate press {arrow left}":PRINT:PRINT"press key to continue
270 GETB$:IFB$=""THEN270
930 S(3)=S(3)+1
940 PRINT"{clear}{green}do you want to play against me ":PRINT"or another player(2){space*2}enter 1 or 2:";
960 GETA1$:IFA1$=""THEN960
970 A1=VAL(A1$):IFA1<1ORA1>2THEN940
980 IFA1=1THEN1000
982 PO=0:GOSUB26000:GOSUB10400:GOTO940
1000 PRINT"{clear}{down*3}":PRINT"{reverse on}set skill level of computer :":PRINT"{reverse on}enter 1-5:1 for easy{space*2}5 for{space*2}hard:";:PI=0
1006 GETA$:IFA$=""THEN1006
1007 ZX=VAL(A$):IFZX<1ORZX>5THEN1000
1010 IFS(9)=1THEN1200
1012 GOSUB10400:GOSUB10000:PRINT:PRINT"{reverse on}first go (y or n)?";
1040 A1$="":A$="
1050 GETA1$:IFA1$=""THEN1050
1051 IFASC(A1$)=13THEN1060
1052 A$=A$+A1$:GOTO1050
1060 PRINT"{reverse on}"A$:GOSUB12800:IFS(1)=1THEN1040
1080 IFS(2)=0THEN1130
1090 GOSUB12100:GOSUB11000:GOSUB10000
1130 GOSUB12900:GOSUB10000
1200 GOSUB12100:GOSUB10000:GOSUB12900:GOSUB10000:GOSUB12100:GOSUB10000:GOSUB16700:IFS(8)=1THEN1000
1275 IFS(8)=2THEN9990
1280 GOSUB12900:GOSUB10000:GOSUB16700:IFS(8)=1THEN1000
1296 IFS(8)=2THEN9990
1300 GOSUB12100:GOSUB10000:GOSUB16700:IFS(8)=1THEN1000
1330 IFS(8)=2THEN9990
1340 GOSUB12900:GOSUB10000:GOSUB16700:IFS(8)=1THEN1000
1370 IFS(8)=2THEN9990
1380 GOSUB12100:GOSUB10000:GOSUB16700:IFS(8)=1THEN1000
1410 IFS(8)=2THEN9990
1420 IFS(3)=9THEN1500
1430 GOSUB12900:GOSUB10000:GOSUB16700:IFS(8)=1THEN1000
1470 IFS(8)=2THEN9990
1500 PRINT"{reverse on}stalemate another go";:INPUTA$:IFA$="yes"ORA$="y"ANDPI<>0THENGOSUB10400
1534 IFA$="yes"ORA$="y"ANDPI<>0THENRETURN
1540 IFA$="yes"ORA$="y"THEN1000
9990 STOP
10000 PRINT"{clear}{down*3}":GOSUB20000:ZY=INT(RND(0)*5):ZZ=0:IFZX>ZYTHENZZ=3
10330 PRINT:RETURN
10400 FORA1=1TO3:FORA2=1TO3:A(A1,A2)=0:NEXTA2:NEXTA1:FORA1=1TO8:S(A1)=0:NEXTA1:Z6=Z6+1:RETURN
11000 GOSUB15400
11100 IFB(1,1)+B(1,2)+B(1,3)+B(2,2)=1THEN11200
11110 S(4)=S(4)+1:GOSUB15100:GOTO11100
11200 IFB(1,3)<>1THEN11990
11210 S(5)=1:GOSUB15300
11990 RETURN
12002 TB=9
12100 S(3)=S(3)+1:PRINT:IFPI=1THENP$="crosses
12111 IFPI=2THENP$="noughts
12112 IFPI>0THENPRINT"{reverse on}player "P$
12120 PRINT"{reverse on}enter row/col";:S(1)=0
12142 GETA1$:IFA1$=""THEN12142
12144 IFASC(A1$)=95THEN1500
12146 IFASC(A1$)=13THEN12142
12151 PRINT"{reverse on}row#:"A1$
12152 GETA2$:IFA2$=""THEN12152
12154 PRINT"{reverse on}{space*2}column#:"A2$:A$=A1$:GOSUB12400:IFS(1)=1THENPRINT"{reverse on}enter 1-3 only
12180 IFS(1)=1THENPRINT"{reverse on}{up*2}";
12182 IFS(1)=1THEN12120
12190 A$=A2$:S(1)=0:GOSUB12400:IFS(1)=1THENPRINT"{reverse on}enter 1-3 only
12209 IFS(1)=1THENPRINT"{reverse on}{up*2}";
12210 IFS(1)=1THEN12120
12220 A1=INT(VAL(A1$)):A2=INT(VAL(A2$)):S(1)=0:GOSUB12600:IFS(1)<>1THEN12300
12270 PRINT"taken{space*2}":PRINT"{reverse on}{up*2}";:GOTO12120
12300 A(A1,A2)=1:IFPI=1THENA(A1,A2)=4
12310 RETURN
12400 A1=INT(VAL(A$)):IFA1>0ANDA1<4THEN12490
12430 S(1)=1
12490 RETURN
12600 S(1)=0:IFA(A1,A2)=0THEN12790
12650 S(1)=1
12790 RETURN
12800 S(1)=0:IFA$="yes"ORA$="y"THEN12880
12815 S(2)=0:IFA$="no"ORA$="n"THEN12890
12830 PRINT:PRINT"{reverse on}answer yes or no";:PRINT:S(1)=1:GOTO12890
12880 S(2)=1
12890 RETURN
12900 GOSUB15600:IFS(3)<>0THEN13000
12915 S(4)=INT(RND(Z6)*3.999):S(5)=INT(RND(Z6)*1.999):GOSUB15600:IFZZ=3THENB(1,1)=4
12922 IFZZ<>3THENB(2,2)=4
12930 S(3)=S(3)+1:GOTO14980
13000 IFS(3)<>1THEN13100
13020 S(3)=S(3)+1:IFB(2,2)=1THEN13090
13040 IFZZ=3THENB(2,2)=4
13042 IFZZ<>3ANDB(1,1)<>1THENB(1,1)=4
13044 IFZZ<>3ANDB(1,1)=1THENB(1,3)=4
13050 GOTO14980
13090 IFZZ=3THENB(1,1)=4
13092 IFZZ<>3THENB(1,2)=4
13095 GOTO14980
13100 IFS(3)<>2THEN13170
13105 S(3)=S(3)+1:IFB(1,2)+B(1,3)+B(2,3)=1THEN13140
13120 B(2,3)=4:GOTO14980
13140 B(3,2)=4:GOTO14980
13170 IFS(3)<>3THEN13540
13190 S(3)=S(3)+1:GOSUB16010:GOSUB16200:IFS(6)=0THEN13250
13230 GOSUB16300:GOTO14980
13250 IFB(2,2)<>1THEN13280
13260 B(3,1)=4:GOTO14980
13280 IFB(1,2)=0ANDB(2,3)=1THEN13350
13290 IFB(1,2)<>0ANDB(3,2)<>1THEN13320
13292 IFB(3,2)<>0THEN13300
13294 B(3,2)=4:GOTO14980
13300 B(3,1)=4:GOTO14980
13320 IFT(4)<>1THEN13350
13330 B(1,1)=4:GOTO14980
13350 B(1,3)=4:GOTO14980
13540 IFS(3)<>4THEN13800
13560 S(3)=S(3)+1:GOSUB16010:GOSUB16200:IFS(6)=0THEN13620
13600 GOSUB16300:GOTO14980
13620 IFB(2,2)<>0THEN13650
13630 B(2,2)=4:GOTO14980
13650 GOSUB17000:GOTO14980
13800 S(3)=S(3)+1:GOSUB16010:GOSUB16200:IFS(6)=0THEN13880
13860 GOSUB16300:GOTO14980
13880 GOSUB17000:GOTO14980
14980 GOSUB15900:RETURN
15000 FORA1=1TO3:FORA2=1TO3:B(A1,A2)=0:NEXTA2:NEXTA1:RETURN
15100 FORA1=1TO3:C(3,A1)=B(A1,1):C(4-A1,3)=B(3,A1):C(1,4-A1)=B(4-A1,3):C(A1,1)=B(1,4-A1):NEXTA1:C(2,2)=B(2,2):GOSUB15200:RETURN
15200 FORA1=1TO3:FORA2=1TO3:B(A1,A2)=C(A1,A2):NEXTA2:NEXTA1:RETURN
15300 FORA1=1TO3:C(A1,1)=B(A1,3):C(A1,3)=B(A1,1):C(A1,2)=B(A1,2):NEXTA1:GOSUB15200:RETURN
15400 FORA1=1TO3:FORA2=1TO3:B(A1,A2)=A(A1,A2):NEXTA2:NEXTA1:RETURN
15500 FORA1=1TO3:FORA2=1TO3:A(A1,A2)=B(A1,A2):NEXTA2:NEXTA1:RETURN
15600 GOSUB15400:IFS(4)=0THEN15800
15660 FORA3=1TOS(4):GOSUB15100:NEXTA3
15800 IFS(5)=0THEN15850
15810 GOSUB15300
15850 RETURN
15900 IFS(5)=0THEN15950
15920 GOSUB15300
15950 IFS(4)=0THEN15990
15960 FORA3=1TO4-S(4):GOSUB15100:NEXTA3
15990 GOSUB15500:RETURN
16010 FORA1=1TO8:T(A1)=0:NEXTA1:FORA1=1TO3:T(1)=T(1)+B(1,A1):T(2)=T(2)+B(2,A1):T(3)=T(3)+B(3,A1):T(4)=T(4)+B(A1,1):T(5)=T(5)+B(A1,2):T(6)=T(6)+B(A1,3):T(7)=T(7)+B(A1,A1):T(8)=T(8)+B(4-A1,A1):NEXTA1:RETURN
16200 FORA1=1TO8:IFT(A1)=8THENS(6)=A1
16230 IFS(6)<>0THEN16250
16240 IFT(A1)=2THENS(6)=A1
16250 NEXTA1:RETURN
16300 T(9)=T(S(6))+4:FORA3=1TO3:FORA2=1TO3:IFB(A3,A2)<>0THEN16600
16340 IFS(7)=1THEN16600
16350 B(A3,A2)=4:GOSUB16010:IFT(S(6))<>T(9)THEN16500
16480 S(7)=1:GOTO16600
16500 B(A3,A2)=0
16600 NEXTA2:NEXTA3:S(7)=0:S(6)=0:RETURN
16700 GOSUB15600:GOSUB16010:FORA1=1TO8:IFS(8)=1THEN16900
16770 IFT(A1)<>12THEN16820
16780 C1=C1+1:S(8)=1:PRINT"{reverse on}";:IFPI<>0THENPRINT"cross wins:o's{space*2}x's
16786 IFPI<>0THEN16796
16790 S(8)=1:PRINT"computer wins!{space*2}you{space*3}computer
16796 PRINTTAB(12)Y1;TAB(18)C1:GOTO16900
16820 IFT(A1)<>3THEN16900
16840 Y1=Y1+1:S(8)=1:IFPI<>0THENPRINT"nought wins:o's{space*2}x's":IFPI<>0THEN16870
16860 PRINT"you win!{space*2}you{space*4}computer
16870 PRINT:PRINT"{reverse on}";:PRINTTAB(12)Y1;TAB(18)C1:PRINT
16900 NEXTA1:IFS(8)<>1THEN16990
16910 PRINT"{reverse on}";:PRINT"another game ?":PI=0:PRINT:INPUTA$:IFA$="no"ORA$="n"THEN16980
16950 GOTO16990
16980 S(8)=2
16990 RETURN
17000 IFB(3,3)<>0THEN17010
17004 B(3,3)=4:GOTO17090
17010 FORA1=1TO3:FORA2=1TO3:IFS(7)=1THEN17060
17035 IFB(A1,A2)<>0THEN17060
17040 S(7)=1:B(A1,A2)=4
17060 NEXTA2:NEXTA1:S(7)=0
17090 RETURN
20000 TB=10:FORA1=1TO3STEP.5:IFA1=INT(A1)THEN21200
21060 PRINTTAB(TB)"{space*4}{cm +}{space*5}{cm +}":FORA5=1TO15:PRINTTAB(TB)"{cm +}";:NEXTA5:PRINT:PRINTTAB(TB)"{space*4}{cm +}{space*5}{cm +}":GOTO21500
21200 FORA4=1TO3:FORA2=1TO3STEP.5:IFA2=INT(A2)THEN21250
21230 PRINTTAB(TB)" {cm +} ";:GOTO21350
21250 IFA(A1,A2)=1ANDA4<>2THENPRINTTAB(TB)"{purple}QQQ{green}";
21260 IFA(A1,A2)=1ANDA4=2THENPRINTTAB(TB)"{purple}Q Q{green}";
21270 IFA(A1,A2)=4ANDA4=2THENPRINTTAB(TB)"{cyan} Q {green}";
21280 IFA(A1,A2)=4ANDA4<>2THENPRINTTAB(TB)"{cyan}Q Q{green}";
21290 IFA(A1,A2)=0THENPRINTTAB(TB)"{space*3}";
21350 NEXTA2:PRINT"{green}":NEXTA4
21500 NEXTA1:RETURN
26000 PO=PO+1:IFPO=1THENPI=2
26040 IFPO=2THENPI=1
26050 GOSUB12100:IFPO=2THENPO=0
26054 GOSUB10000:GOSUB16700:IFS(3)=9THEN1500
26056 IFPI=0THEN26090
26060 GOTO26000
26090 RETURN
