!--------------------------------------------------
!- 28 October 2019 21:17:10
!- Import of : SUB.PRG
!- From Disk : c:\users\marka\games\c64\cbmprg\cassette50reboot\submarines.d64
!- Commodore 64
!--------------------------------------------------
100 GOSUB1000:POKE53280,7:POKE53281,5:PRINT"{blue}":GOSUB2500:IFA$="q"THEN900
200 GOSUB3000:GOSUB3100:GOSUB3600:X=1:Y=H-1:GOSUB1600:PRINT"end of game":FORA=1TO3000:NEXTA:GOTO100
900 GOSUB1500:PRINT"end of game":STOP
1000 W=40:H=21:S1=0:J=0:S$="{space*40}":RETURN
1500 PRINTCHR$(147);:RETURN
1600 PRINTCHR$(19);:Z8=X-1:IFZ8=0THEN1612
1610 FORU=1TOZ8:PRINTCHR$(29);:NEXTU
1612 Z9=Y-1:IFZ9=0THEN1690
1620 FORU=1TOZ9:PRINTCHR$(17);:NEXTU
1690 RETURN
1700 A$=S$:S=1:F=Z:GOSUB1900:PRINTM$:RETURN
1800 RA=RND(1):RETURN
1900 M$=MID$(A$,S,F-S+1):RETURN
2000 RETURN
2300 INPUTQ$:RETURN
2400 IFO=1THENPRINTCHR$(18);
2410 IFO=0THENPRINT"
2490 RETURN
2500 GOSUB1500:PRINT"{space*10}submarines":PRINT"instructions":PRINT:PRINT"your ship is at the top of the screen":PRINT"shown by {cm asterisk}{reverse on}{cm u}{reverse off}{sh pound}.":PRINT"{down}a pack of submarines{space*2}move underneath.":PRINT"{down}release depth charge by pressing any key
2538 PRINT"{down}points are awarded for hitting sub.":PRINT"{down}any key to play,{space*6}q to exit":X=1:Y=22:GOSUB1600:GOSUB2700:RETURN
2600 GETA$:RETURN
2700 GETA$:IFA$=""THEN2700
2790 RETURN
3000 GOSUB1500:A$=S$:S=1:F=W:GOSUB1900:B$=M$:FORA=1TO3:O=1:GOSUB2400:X=1:Y=A:GOSUB1600:PRINT"{blue}"B$:NEXTA:O=0:GOSUB2400:X9=INT(W/2):Y9=INT(H/2):C=1:K=10:RETURN
3100 GOSUB1800:X1=INT(RA*(X9-2))+X9-1:Y1=3:X2=1:Y2=H-1:X3=X1+1:Y3=4:GOSUB3600:IFC=11THENC=10:GOTO3190
3108 GOSUB1800:FORA=1TOINT(RA*2000)+1:NEXTA:GOSUB3400
3110 GOSUB3200:GOSUB3300:X=X3:Y=Y3:GOSUB1600:PRINT" ":X2=X2+1:IFX2=W-2THENC=C+1:GOSUB3500:GOTO3100
3130 GOSUB2600:IFA$<>""ANDY3=4THENK=K-1:Y3=9
3136 IFY3<>4THENY3=Y3+1:IFY3>HTHENY3=H
3138 IFY3<>4THENX=X1+1:Y=Y3:GOSUB1600:PRINT"{black}Z
3140 IFY2=Y3THENIFX3>X2-1ANDX3<X2+3THENGOSUB4000:GOTO3100
3150 GOTO3110
3190 RETURN
3200 X=X2:Y=Y2:GOSUB1600:PRINT"{red}{cm i}{reverse on}{cm c}{reverse off}{cm i}":RETURN
3300 X=X2:Y=Y2:GOSUB1600:PRINT"{space*3}":RETURN
3400 X=X1:Y=Y1:GOSUB1600:PRINT"{purple}{cm asterisk}{reverse on}{cm u}{reverse off}{sh pound}":RETURN
3500 O=1:GOSUB2400:X=X1:Y=Y1:GOSUB1600:PRINT"{blue}{space*3}":O=0:GOSUB2400:RETURN
3600 PRINT"{green}":X=1:Y=6:GOSUB1600:PRINT"{space*10}":GOSUB1600:PRINTK" charges left{space*3}":Y=8:GOSUB1600:PRINT"submarine "C"{space*2}":Y=10:GOSUB1600:PRINTJ" hits{space*3}":RETURN
4000 C=C+1:GOSUB3500:GOSUB3300:X=X3:Y=Y3:GOSUB1600:PRINT" ":J=J+1:GOSUB2000:RETURN
